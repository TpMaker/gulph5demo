!function(){function t(){var t='<div class="axd-basicBox" id="J_lottery" style="background-image:url('+m+')"></div>';$(".J_lotterybox").append(t).addClass("axd-outer"),window.gua=new h({id:"J_lottery",lottery:{type:"text",info:" ",color:"#777777",bgColor:"transparent"},cover:{info:g,type:"image"}});var i='<div class="axd-mask-info" id="J_maskInfo"></div>';$(".J_lotterybox").append(i),s(),e()}function e(){var t=i();$.ajax({url:v+"/activity/gua/getGuaTelphone",dataType:"jsonp",data:t,success:function(t){t.success&&t.result?"0"===t.result?(n(),r()):t.result>0&&(n(),a(t.resultDes,t.code)):n()},error:function(t){n(),o()}})}function i(){for(var t={telephone:"",name:"",source:"",notifyurl:"false",sign:""},e=$("#axd-form input"),i=0;i<e.length;i++)if(t.hasOwnProperty(e[i].name)){var o=e[i].name;t[o]=e[i].value}return t}function o(){var t=$("#J_maskInfo"),i='<div class="axd-info-outer"><div class="axd-info-mid" style="height:'+$(".J_lotterybox").height()+'px"><p>>_< 奖品迟到了</p><a href="javascript:;" class="J_loadFail">重新刮奖</a></div></div>';t.html(i),$(".J_loadFail").on("click",function(){s(),e()},!1)}function a(t,e){var o=$("#J_maskInfo"),a="",s='<div class="axd-info-outer"><div class="axd-info-mid" style="height:'+$(".J_lotterybox").height()+'px"><p>'+t+'</p><a href="javascript:;" class="J_loadSuccess">点击刮奖</a></div></div>';o.html(s),a="90"===e?"1元购爱奇艺会员月卡的资格":"91"===e?"1元包邮全场任选的资格":"100 元爱学贷新人红包",a='<div class="axd-award-box"><p>恭喜获得<span class="axd-award-color">'+a+'</span></p><p>奖品将<strong class="axd-award-color">发送至您的手机上</strong></p></div>',window.gua.drawLottery({lottery:{type:"text",info:a,color:"#777777",bgColor:"transparent"},drawPercentCallback:function(){var t=i();$.ajax({url:v+"/activity/gua/playGuaActive",dataType:"jsonp",data:{telephone:t.telephone}})}}),$(".J_loadSuccess").on("click",function(){o.remove()},!1)}function s(){var t=$("#J_maskInfo"),e='<div class="axd-loading"><div class="axd-loading-box"></div></div>';t.html(e)}function n(){var t=$("#J_maskInfo");t.html("")}function r(){var t='<div class="axd-award-box"><p class="axd-hasAward-info">您已经刮过奖啦，去爱学贷客户端领取吧</p><p class="axd-hasAward-detail">有疑问请联系爱学贷客服400-867-1888</p></div>';window.gua.drawMask({cover:{info:" ",type:"text",fontSize:"25",fontColor:"white",bgColor:"transparent"},lottery:{type:"text",info:t,color:"#777777",bgColor:"transparent"}})}function h(t){this.options={id:"lottery",drawPercentCallback:null,coreArea:{widthPercentage:.6,heightPercentage:.6},lottery:{type:"text",info:"",color:"#3a195a",bgColor:"white"},cover:{info:" ",type:"text",fontSize:"25",fontColor:"white",bgColor:"gray"},callLevel:80},this._options=l(this.options,t),this.conId=this._options.id,this.conNode=document.getElementById(this.conId),this.drawPercentCallback=this._options.drawPercentCallback,this.iscallback=!0,this.callLevel=this._options.callLevel,this.width=this.conNode.offsetWidth,this.height=this.conNode.offsetHeight,this.radius=Math.floor(this._options.radius*this.width)||25,this.lottery=this._options.lottery,this.cover=this._options.cover,this.m_width=Math.floor(this._options.coreArea.widthPercentage*this.width),this.m_height=Math.floor(this._options.coreArea.heightPercentage*this.height),this.m_x=(this.width-this.m_width)/2,this.m_y=(this.height-this.m_height)/2,this.device=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()),this.clickEvtName=this.device?"touchstart":"mousedown",this.moveEvtName=this.device?"touchmove":"mousemove",this.background=null,this.mask=null,this.maskCtx=null,this.coverChunk=null,this.drawMask()}function l(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function c(t){var e=t.offsetTop;return null!=t.offsetParent&&(e+=c(t.offsetParent)),e}function d(t){var e=t.offsetLeft;return null!=t.offsetParent&&(e+=d(t.offsetParent)),e}function u(t,e,i,o){var a=[],s=[],n=0;if(t.length===e.length){for(var r=0;r<t.length;r++){var h=f(e[r]),l=h*t[r]/2;n+=1.5*t[r],a.push(l)}for(var c=[],d=[],u=0;u<a.length;u++)c[u]=0==u?(o-n)/2:c[u-1]+1.5*t[u-1],d[u]=(i-a[u])/2,s.push({x:d[u],y:c[u]})}else console.log("传入的字体长度和字符长度不一致！");return s}function f(t){for(var e=0,i=0;i<t.length;i++)e+=null!=t[i].match(/[^\x00-\xff]/gi)?2:1;return e}var v,m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA4QAAADcAgMAAABVFYevAAAADFBMVEX/4uM6iv7+dVL+0h39JT1cAAACZklEQVR42u3dz4nbQBiG8XdHGIIu2oPVQ9ApHXhLyGHdj0vxcZkqXJILMEyUDeQgB8YExqvv1fNrQDys5tMfZmUBAAAAALAB3+TOv/C73H3IXLIv7GMX/rAvvKpqCl3Y3VSVQxcORTUpduFhNYVJbZRyUUX/nML+pBa6Uq4rKWw0z+bCmyqmJxVmtTCUUlZSmPNZDRxKfSHmpxSmhoXXtRSe1MBQZpVDP6ewz1ktdGV2WUdho6OU2XUNhc3m2aHM1lF41qcmhRfnwqHMbv8xxsMUduW3S+3Y7eV8UhulOmtS8MJDqc6a6aR7cQqHemGKXdj9GTVfLmc18ffW9Ms1LBxWUvihVrrPq0XV+K6mJrUzF6puPL4rqqHcHio8/lRQ3aOFR0V1uD5Y+KaoLvaFopBCC6FnKYUUmqAwvk0Uxn18opBCExTGt4nCsG+iKKTQBYXxje4voig0QGF8o/tLDAoNUBjfFgrNH/EpNLCFQvPHQwoNUBjf6P54SKGB0f3Gm0IDGyh0v/H+R+EkL3eFKZ9kZVzetPX5LCt3hTn2h3nqhcmv8O3uKw9ZVpaFU85mo2ZcLkP3wmRf2Ge7dbi/W4Zu18O9+6DR62LQ2F0OF4XJ7yRd6P1O0oXJbpIuTX7LcGFyP0nV2xcm92UY/cu7j5i8r4azyXwZSr3cJfnYuW/SPx7N/6XrhcLwKIyPwvg2UbgzL3TfJwQAAAAAAAAAAAAAAFyN7tseXuw/ALMz34oruW821ov59jFpZ1/o/xsg9j+guIll6P0nlPk21U1c7/3v2WT/OTTt5e5VAAAAAAAAAAAAqPsFhcMg7fIXrNUAAAAASUVORK5CYII=",g="data:image/png;base64,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";v=window.location.href.indexOf("dev.izhuan365.com")>0?"https://mtest.aixuedai.com:10454":"https://m.aixuedai.com",h.prototype={drawMask:function(t){var e=this;if(t&&(e.lottery=t.lottery?l(e.lottery,t.lottery):e.lottery,e.drawPercentCallback=t.drawPercentCallback?t.drawPercentCallback:e.drawPercentCallback,e.cover=t.cover?t.cover:e.cover),e.iscallback=!0,this.conNode.innerHTML="",this.background=this.createElement("div",{style:"position:absolute;left:0;top:0;width:100%;height:100%;text-align: center;background: transparent no-repeat;background-size:100% 100%;z-index:98;",id:"axd-canvas-bg"}),this.mask=this.createElement("canvas",{style:"position:absolute;left:0;top:0;width:100%;height:100%;z-index:99;",id:"canvas"}),this.conNode.appendChild(this.mask),this.conNode.appendChild(this.background),this.bindEvent(),this.maskCtx=this.mask.getContext("2d"),this.resizeCanvas(),"text"===this.cover.type){if(this.maskCtx.fillStyle=this.cover.bgColor,this.maskCtx.fillRect(0,0,this.width,this.height),this.cover.fontSize&&this.cover.fontColor&&this.cover.info){var i=this.cover.fontSize.split("|"),o=this.cover.fontColor.split("|"),a=this.cover.info.split("|"),s=i.length;if(i.length==o.length&&o.length==a.length)for(var n=u(i,a,e.width,e.height),r=0;r<s;r++)this.maskCtx.font=i[r]+"px Arial",this.maskCtx.fillStyle=o[r],this.maskCtx.textBaseline="top",this.maskCtx.fillText(a[r],n[r].x,n[r].y)}}else if("image"===this.cover.type){var h=new Image;h.src=this.cover.info,h.onload=function(){e.maskCtx.drawImage(this,0,0,this.width,this.height,0,0,e.width,e.height),e.maskCtx.globalCompositeOperation="destination-out"}}this.drawLottery()},drawLottery:function(t){var e=this;t&&(e.lottery=t.lottery?l(e.lottery,t.lottery):e.lottery,e.drawPercentCallback=t.drawPercentCallback?t.drawPercentCallback:e.drawPercentCallback),"image"===e.lottery.type?(this.background.innerHTML="",this.background.style.backgroundColor="",this.background.style.backgroundImage="url("+e.lottery.info+")"):"text"===e.lottery.type&&(this.background.style.backgroundImage="url()",this.width=this.width,this.height=this.height,this.background.innerHTML=this.lottery.info,this.background.style.color=this.lottery.color,this.background.style.backgroundColor=e.lottery.bgColor)},createElement:function(t,e){var i=document.createElement(t);for(var o in e)i.setAttribute(o,e[o]);return i},getTransparentPercent:function(t){for(var e=t.getImageData(this.m_x,this.m_y,this.m_width,this.m_height),i=e.data,o=[],a=0,s=i.length;a<s;a+=4){var n=i[a+3];n<128&&o.push(a)}return(o.length/(i.length/4)*100).toFixed(2)},resizeCanvas:function(){this.mask.width=this.width,this.mask.height=this.height,this.mask.getContext("2d").clearRect(0,0,this.mask.width,this.mask.height)},drawPoint:function(t,e){var i=this;this.maskCtx.beginPath(),this.maskCtx.arc(t,e,this.radius,0,2*Math.PI,!0),this.maskCtx.fill(),this.drawPercentCallback&&this.getTransparentPercent(this.maskCtx)>=this.callLevel&&i.iscallback&&(i.iscallback=!1,i.mask.parentNode.removeChild(i.mask),i.drawPercentCallback())},bindEvent:function(){var t=this;if(t.device)t.mask.addEventListener("touchmove",function(t){e&&t.preventDefault()},!1),t.mask.addEventListener("touchend",function(t){e=!1},!1);else{var e=!1;t.mask.addEventListener("mouseup",function(t){e=!1},!1)}this.mask.addEventListener(t.clickEvtName,function(i){e=!0,t.maskCtx&&"destination-out"!==t.maskCtx.globalCompositeOperation&&(t.maskCtx.globalCompositeOperation="destination-out");var o={top:c(t.conNode),left:d(t.conNode)},a=(t.device?i.touches[0].clientX:i.clientX)-o.left,s=(t.device?i.touches[0].clientY:i.clientY)-o.top;t.drawPoint(a,s)},!1),this.mask.addEventListener(t.moveEvtName,function(i){if(!t.device&&!e)return!1;t.maskCtx&&"destination-out"!==t.maskCtx.globalCompositeOperation&&(t.maskCtx.globalCompositeOperation="destination-out");var o={top:c(t.conNode),left:d(t.conNode)},a=(t.device?i.touches[0].clientX:i.clientX)-o.left,s=(t.device?i.touches[0].clientY:i.clientY)-o.top;t.drawPoint(a,s)},!1)}},$(function(){t()})}();